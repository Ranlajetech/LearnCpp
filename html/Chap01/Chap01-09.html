<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>
        1.9 -- 字面值与运算符简介
    </title>

    <link rel="stylesheet" href="../../css/main.css"/>
    <link rel="stylesheet" href="../../css/highlightjs.css">
    <link rel="stylesheet" href="../../css/linenumbercool.css"/>
    <script src="../../script/highlight.js"></script>
    <script src="../../script/highlight-cpp.js"></script>
    <script src="../../script/highlightjs-line-numbers.js"></script>
    <script>hljs.highlightAll();</script>
    <script>hljs.initLineNumbersOnLoad({singleLine: true});</script>
</head>

<body>
<h1>
    1.9 -- 字面值与运算符简介
</h1>
<h2>
    字面值
</h2>
<p>
    考察以下两条语句：
</p>
<pre><code class="language-cpp">std::cout &lt;&lt; &quot;Hello world!&quot;;
int x { 5 };</code></pre>
<p>
    <code class="lighter">&quot;Hello world!&quot;</code> 和 <code class="lighter">5</code> 是什么？这就是字面值。<strong>字面值</strong>（<strong>literal</strong>），也称 <strong>字面量</strong>（<strong>literal constant</strong>），是直接插入到源代码的固定值。
</p>
<p>
    字面值和变量都有值和类型，但与变量的值可以在初始化和赋值时设置和更改不同，字面值的值是固定的（<code class="inline">5</code> 永远是 <code class="inline">5</code>）。这就是为什么字面值又称为常量。
</p>
<p>
    下面更深入地说明字面值和变量的区别，考察以下程序：
</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;

int main()
{
    std::cout &lt;&lt; 5 &lt;&lt; &apos;\n&apos;; // 显示字面量的值

    int x { 5 };
    std::cout &lt;&lt; x &lt;&lt; &apos;\n&apos;; // 显示变量的值
    return 0;
}</code></pre>
<p>
    第 5 行在控制台显示值 <code class="inline">5</code>。编译时，会产生让 <code class="inline">std::cout</code> 显示值 <code class="inline">5</code> 的代码，这个 <code class="inline">5</code> 直接编译进可执行文件里，可以直接使用。
</p>
<p>
    在第 7 行创建了变量 <code class="inline">x</code>，然后初始化为值 <code class="inline">5</code>。编译产生的代码会把字面值 <code class="inline">5</code> 复制到分配给 <code class="inline">x</code> 的内存位置。在第 8 行显示 <code class="inline">x</code> 时，编译产生的代码会让 <code class="inline">std::cout</code> 显示 <code class="inline">x</code> 所在内存位置的值，也就是 <code class="inline">5</code>。
</p>
<p>
    因此，两条输出语句都做了相同的事（显示 <code class="inline">5</code>）。但在字面值情况下，值 <code class="inline">5</code> 是直接显示的；而在变量情况下，值 <code class="inline">5</code> 必须要到变量代表的内存位置去取回。
</p>
<p>
    这也是为什么字面值是常量而变量可以变化。字面值的值直接放在了可执行文件里，而可执行文件创建之后就不会再更改。变量的值放在内存里，内存里的值可以在执行过程中更改。
</p>
<div class="learncpp-blocktext-violet">
    <p class="learncpp-block-title">
        知识重点
    </p>
    <p>
        字面值是直接插入到源代码的值，一般直接出现在可执行文件里（除非被优化掉了）。
    </p>
    <p>
        对象和变量代表它们储存值的内存位置。它们的值可供提取。
    </p>
</div>
<h2>
    运算符
</h2>
<p>
    在数学里，<strong>运算</strong>（<strong>operation</strong>）是包括零个或更多输入值（称为 <strong>操作数</strong>（<strong>operands</strong>）以产生新值（称为 <strong>输出值</strong>（<strong>output value</strong>））的过程。用来表示特定运算的符号称为 <strong>运算符</strong>（也称 <strong>操作符</strong>，<strong>operator</strong>）。
</p>
<p>
    例如，小时候大家都学过 <code>2 + 3</code> 等于 <code>5</code>。这里 <code>2</code> 和 <code>3</code> 是操作数，符号 <code>+</code> 是运算符，告诉我们要做对两个操作数做加法，产生值 <code>5</code>。
</p>
<p>
    C++ 的运算和预期一致。例如：
</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;

int main()
{
    std::cout &lt;&lt; 1 + 2 &lt;&lt; &apos;\n&apos;;

    return 0;
}</code></pre>
<p>
    这里字面值 <code class="inline">1</code> 和 <code class="inline">2</code> 是加运算符 <code class="inline">+</code> 的操作数，产生输出值 <code class="inline">3</code>。然后输出值显示到控制台上。在 C++ 里，操作的输出值一般叫做 <strong>返回值</strong>（<strong>return value</strong>）。
</p>
<p>
    你很可能已经很熟悉那些和数学上的用法一致的标准数学运算符，包括加减乘除（<code class="inline">+ - * /</code>）。C++ 里，赋值（<code class="inline">=</code>）、插入（<code class="inline">&lt;&lt;</code>）、抽取（<code class="inline">&gt;&gt;</code>）、相等（<code class="inline">==</code>）都是运算符。绝大多数运算符都有个符号，但也有一些运算符是关键字（比如 <code class="inline">new</code>，<code class="inline">delete</code> 与 <code class="inline">throw</code>）。
</p>
<div class="learncpp-blocktext-grey">
    <p class="learncpp-block-title">
        作者的话
    </p>
    <p>
        由于某个以后在详细介绍运算符时会提及的原因，经常会在运算符符号前加上单词 <code>operator</code>。
    </p>
    <p>
        比如，加运算符写作 <code class="inline">operator+</code>，抽取运算符写作 <code class="inline">operator>></code>。
    </p>
</div>
<p>
    运算符接受的输入操作数的数量称为运算符的 <strong>元数</strong>（<strong>arity</strong>）。极少有人知道这个词的含义，所以不要抛出这个词，以为大家都知道你在说什么。C++ 运算符有四种元数：
</p>
<p>
    <strong>一元</strong>（<strong>unary</strong>）运算符作用于一个操作数。一元运算符的例子有 <code class="inline">-</code> 运算符。比如在 <code class="inline">-5</code> 里，<code class="inline">operator-</code> 接受操作数 <code class="inline">5</code>，翻转它的符号，产生新输出值 <code class="inline">-5</code>。
</p>
<p>
    <strong>二元</strong>（<strong>binary</strong>） 运算符作用于两个操作数，有左右之分，左操作数在运算符左侧，右操作数在运算符右侧。二元运算符的例子有 <code class="inline">+</code> 运算符。比如在 <code class="inline">3 + 4</code> 里，<code class="inline">operator+</code> 接受左操作数 <code class="inline">3</code> 和右操作数 <code class="inline">4</code>，对它们做加法，产生新输出值 <code class="inline">7</code>。插入（<code class="inline">&lt;&lt;</code>）与抽取（<code class="inline">&gt;&gt;</code>）运算符也是二元运算符，以 <code class="inline">std::cout</code> 与 <code class="inline">std::cin</code> 为左操作数，要输出的变量或接受输入的变量为右操作数。
</p>
<p>
    <strong>三元</strong>（<strong>ternary</strong>）运算符作用于三个操作数。C++ 只有条件运算符是三元运算符，以后会讲。
</p>
<p>
    <strong>零元</strong>（<strong>nullary</strong>）运算符作用于零个操作数。C++ 只有 <code>throw</code> 运算符是零元运算符，以后会讲。
</p>
<p>
    注意到有些运算符根据它的使用方式会有多个含义。比如，<code class="inline">operator-</code> 有两种上下文环境。可以当作一元运算符来翻转数字的符号（比如把 <code class="inline">5</code> 转换成 <code class="inline">-5</code>，或者反过来），或者可以当作二元运算符做减法（比如 <code class="inline">4 - 3</code>）。
</p>
<h2>
    运算符串联
</h2>
<p>
    运算符可以串联到一起，一个运算符的输出可用于另一个运算符的输入。例如 <code class="inline">2 * 3 + 4</code>，先算乘法，然后把左操作数 <code class="inline">2</code> 和右操作数 <code class="inline">3</code> 替换成返回值 <code class="inline">6</code>，成为加法运算符的左操作数。然后执行加法运算符，把左操作数 <code class="inline">6</code> 和右操作数 <code class="inline">4</code> 替换成新值 <code class="inline">10</code>。
</p>
<p>
    等到详细讲解运算符时会讨论运算符的执行顺序。目前只需要知道数学运算符和数学中的运算顺序相同：先算括号里的，再算乘方，然后是乘除，最后是加减。
</p>
<h2>
    返回值和副作用
</h2>
<p>
    绝大多数 C++ 运算符都是使用操作数来计算出返回值。例如，<code class="inline">-5</code> 返回值 <code class="inline">-5</code>，<code class="inline">2 + 3</code> 返回值 <code class="inline">5</code>。有些运算符没有返回值，比如 <code class="inline">delete</code> 与 <code class="inline">throw</code>。以后再讲。
</p>
<p>
    某些运算符有额外的行为。如果运算符（或函数）会产生除了返回值以外的其他能观察到的影响，则称它具有 <strong>副作用</strong>（<strong>side effect</strong>）。例如执行 <code class="inline">x = 5</code> 时，赋值运算符就有给变量 <code class="inline">x</code> 赋值为 5 的副作用，因为它改变变量 <code class="inline">x</code> 的值的行为在运算符执行完成之后能被观察到，比如通过显示 <code class="inline">x</code> 的值。<code class="inline">std::cout &lt;&lt; 5</code> 具有把 <code class="inline">5</code> 显示到控制台的副作用，因为在它执行完之后还能在控制台看到它显示的值。
</p>
<p>
    有副作用的运算符一般会以它的副作用而不是返回值命名。
</p>
<div class="learncpp-blocktext-grey">
    <p class="learncpp-block-title">
        延申阅读
    </p>
    <p>
        对于那些可以用返回值称呼的运算符，它们的返回值一般都很直观，比如 <code class="inline">operator+</code> 与 <code class="inline">operator*</code> 的返回值分别是两操作数的和与积。
    </p>
    <p>
        对于那些用副作用来称呼的运算符，比如 <code class="inline">operator=</code> 与 <code class="inline">operator&lt;&lt;</code>，它们的返回值一般不是很明显。举个例子，你认为 <code class="inline">x = 5</code> 的返回值会是什么？
    </p>
    <p>
        <code class="inline">operator=</code> 与 <code class="inline">operator&lt;&lt;</code>（当用于向控制台显示要输出的值时）的返回值都是它们的左操作数。也就是 <code class="inline">x = 5</code> 返回 <code class="inline">x</code>，而 <code class="inline">std::cout &lt;&lt; 5</code> 返回 <code class="inline">std::cout</code>。这样这些运算符都可以串联使用。
    </p>
    <p>
        例如，<code class="inline">x = y = 5</code> 运行起来等同于 <code class="inline">x = (y = 5)</code>。首先 <code class="inline">y = 5</code> 把 <code class="inline">5</code> 赋给 <code class="inline">y</code>，返回 <code class="inline">y</code>，后者再被赋给 <code class="inline">x</code>。
    </p>
    <p>
        <code class="inline">std::cout &lt;&lt; &quot;Hello &quot; &lt;&lt; &quot;world&quot;</code> 运行起来等同于 <code class="inline">(std::cout &lt;&lt; &quot;Hello &quot;) &lt;&lt; &quot;world!&quot;</code>。首先把 <code class="inline">&quot;Hello &quot;</code> 显示到控制台，返回 <code class="inline">std::cout</code>，后者再被用于把 <code class="inline">&quot;world!&quot;</code> 显示到控制台。
    </p>
    <p>
        运算符的运算顺序会在 <a href="../Chap06/Chap06-01.html" target="_blank">6.1 -- 运算符优先级与结合性</a> 深入讲解。
    </p>
</div>
<h2>
    <a href="https://www.learncpp.com/cpp-tutorial/introduction-to-literals-and-operators/#:~:text=Quiz%20time" target="_blank">随堂小测</a>
</h2>
<hr/>
<nav>
    <a href="Chap01-10.html">[ 下一课：1.10 -- 表达式简介 ]</a><br/>
    <a href="../../index.html" target="_blank">[ 目录 ]</a><br/>
    <a href="https://www.learncpp.com/cpp-tutorial/introduction-to-literals-and-operators/" target="_blank">[ 原文地址 ]</a><br/>
    <a href="Chap01-08.html">[ 上一课：1.8 -- 空白符与基础格式化 ]</a>
</nav>
</body>
</html>